setwd("/home/cyril/Documents/Master/sem_1/Case_study/module3/")
files.human <- list.files("PDZLigands/human", pattern="*.fa", full.names=TRUE)
files.worm <- list.files("PDZLigands/worm", pattern="*.fa", full.names=TRUE)
nm <- c()
for (f in files.human){
nm <- c(nm, strsplit(f, split=".pep", fixed=T )[[1]][1])
}
PDZ.human <- c()
nm
for (x in nm){
PDZ.human <- c(PDZ.human, strsplit(x, split="/", fixed=T )[[1]][3])
}
PDZ.human
nm
nm [1]
basename(nm [1])
nm <- lapply(files.worm, function(x){strsplit(x, split=".pep", fixed=T )[[1]][1] })
PDZ.worm <- lapply(nm, function(x){strsplit(x, split="/", fixed=T )[[1]][3] })
PDZ.worm <- unlist(PDZ.worm)   #This is because the output of lapply() is a list and not a vector
PDZ.all <- c(PDZ.human, PDZ.worm)
le <- length(PDZ.all)
PDZ.org <- c(rep("H", length(PDZ.human)), rep("W", length(PDZ.worm)))
names(PDZ.org) <- PDZ.all
PDZ.class <- read.table("PDZclass.txt", skip=1)
class2 <- as.numeric(PDZ.class[,2])
names(class2) <- PDZ.all
class7 <- as.numeric(PDZ.class[,3])
names(class7) <- PDZ.all
class16 <- as.character(PDZ.class[,4])
names(class16) <- PDZ.all
b <- read.table("phageLibraryNNKTheoreticalCodonBias.txt")
bg.fr <- b[,2]
loadFile <- function(x){
f <- read.fasta(file=x, as.string = TRUE, seqtype = "AA")
nm <- names(f)
seq <- unlist(lapply(nm, function(x){f[[x]][1]}))
return(seq)
}
seq.human <- lapply(files.human, loadFile)
seq.worm <- lapply(files.worm, loadFile)
function(x){
